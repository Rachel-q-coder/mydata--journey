# 180.Contiuent-Number

## 题目描述：

#### 表：Logs
```
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| num         | varchar |
+-------------+---------+
```
- 在 SQL 中，id 是该表的主键。
- id 是一个自增列。
- 找出所有至少连续出现三次的数字。
- 返回的结果表中的数据可以按 任意顺序 排列。
  
## 我的思路：

1. **需求分析：** 至少，必须大于等于三次出现，且是连续的
2. **解题思路：** 连续出现，想到了窗口函数的 ***lead*** 通过某个数所在行的下一行，下两行的值放在一起，形成一个新的表。
   
## SQL代码

```
select distinct num as ConsecutiveNums
from
    (select id,num,
        LEAD(num,1) over(order by id) as next1,
        LEAD(num,2) over(order by id) as next2
    from Logs) as log1
where num=next1 and num=next2;

```
## 自连接方法

### SQL代码：
```
select distinct l1.num as ConsecutiveNums
from logs l1, logs l2,logs l3
where l1.id=l2.id-1
and l2.id=l3.id-1
and l1.num=l2.num
and l2.num=l3.num  ;
```

## 总结：
 1. ***LEAD***函数：
   ```
   LEAD(column_name, offset, default_value) OVER (
    [PARTITION BY partition_expression]
    ORDER BY sort_expression
)
   ```